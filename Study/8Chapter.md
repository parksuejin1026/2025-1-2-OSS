# 8. Git 브랜치 병합 및 충돌 해결

## 🤝 브랜치 병합 (Merge) 종류와 옵션

Git 병합은 브랜치 이력 상태에 따라 두 가지 기본 방식으로 수행됨.

### 1. Fast-forward (빨리 감기) 병합
* **발생 조건**: 현재 브랜치가 병합할 브랜치 커밋의 **직접적인 조상**인 일렬 상태일 때 발생함.
* **동작**: 새 커밋 생성 없이, 현재 브랜치 포인터(HEAD)만 대상 커밋으로 **이동**함.
* **결과**: 이력은 선형으로 깔끔하지만, 브랜치 분기 기록은 남지 않음.

### 2. 3-way (Non Fast-forward) 병합
* **발생 조건**: 두 브랜치가 **분기가 갈라져** 있는 상태일 때 (양쪽에서 커밋이 발생한 상태).
* **동작**: 두 변경 내용을 합치는 **새로운 병합 커밋(Merge Commit)**을 생성함.
* **결과**: 브랜치 분기 이력이 기록에 남음.

---

## 🛠️ 주요 병합 옵션

| 옵션 | 명령어 예시 | 설명 |
| :--- | :--- | :--- |
| **기본 병합** | `git merge topic` | 유연하게 병합함. 이력 상태에 따라 Fast-forward나 3-way 병합을 수행함. |
| **Non Fast-forward**| `git merge --no-ff topic` | Fast-forward가 가능해도 **강제로 3-way 병합** 커밋을 생성함. 브랜치 분기 기록을 확실히 남길 때 사용함. |
| **Squash Merge** | `git merge --squash topic` | 대상 브랜치(`topic`)의 **모든 커밋을 하나로 뭉개서** 현재 브랜치에 가져옴. 병합 후 **직접 커밋**을 해야 함. |
| **Fast-forward Only**| `git merge --ff-only topic` | 일렬 상태일 때만 병합을 진행하고, 아니면 거부함. |
| **메시지 지정** | `git merge -m 'merge msg'` | 병합 커밋 메시지를 편집기 실행 없이 바로 입력함. |

---

## 💥 병합 충돌 (Conflict)과 해결

### 1. 충돌 발생
* **원인**: 3-way 병합 시, 두 브랜치에서 **동일 파일의 동일 부분**을 다르게 수정해서 Git이 뭘 쓸지 결정 못할 때 발생함.
* **상태 확인**: `git merge` 시 `CONFLICT` 메시지가 뜨고, `git status`에서 `Unmerged paths`에 `both modified: <파일>` 상태를 볼 수 있음.
* **충돌 표시**: 충돌 파일 내부에는 아래 3가지 표시로 구분되어 있음.
    * `<<<<<<< HEAD` (현재 브랜치 내용)
    * `=======` (경계선)
    * `>>>>>>> {브랜치명}` (병합되는 브랜치 내용)

### 2. 충돌 해결 절차
1.  **파일 수정**: 충돌 파일을 열어 **3개의 충돌 표시를 모두 제거**하고, 두 내용을 통합한 **최종 코드**로 직접 수정해서 저장함.
2.  **해결 표시**: `git add <수정한 파일>`을 실행해서 해결된 상태를 스테이징 영역에 추가함.
3.  **병합 커밋**: `git commit`을 실행해서 충돌 해결을 반영한 **병합 커밋**을 최종 생성함.

### 3. 병합 취소
* **명령어**: `git merge --abort`
* **동작**: 충돌 발생 후 병합을 중단하고 병합 시도 이전 상태로 되돌아감.